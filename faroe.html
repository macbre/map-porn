<!DOCTYPE html> 
<html>
	<title>Faroe Islands - map</title>

	<!-- fonts -->
	<link href="https://fonts.googleapis.com/css2?family=Gudea:wght@400;700&family=Josefin+Sans:wght@100;600&family=Lora:ital,wght@1,400;1,600&display=swap" rel="stylesheet">

	<!-- leaflet -->
	<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"/>
	<script src="static/leaflet-providers.js"></script>
	<script src="static/L.Graticule.js"></script>

	<!-- our assets -->
	<link rel="stylesheet" href="static/map.css">
	<script src="static/map.js"></script>

	<link rel="license" href="https://creativecommons.org/licenses/by/4.0/" />

	<body lang="en">
		<div id="wrapper">
			<section id="overlay">
				<h1 lang="en">Faroe Islands</h1>
				<h1 lang="pl">Wyspy Owcze</h1>

				<h2 lang="en">Public Transport</h2>
				<h2 lang="pl">Transport publiczny</h2>

				<legend>
					<p lang="en">
						The Faroe Islands is served by an internal transport system based on <b>roads, ferries, and helicopters</b>.
					<br><br>
						<b>Strandfaraskip Landsins</b> operates a network of ferries and the rural blue buses.
					<br><br>
						Helicopters operated by <b>Atlantic Airways</b> provide domestic scheduled transportation, medical evacuation, and search & rescue activities.
					</p>
					<p lang="pl">
						Komunikacja na Wyspach Owczych oparta jest o system dróg, tuneli, promów i połączeń realizowanych przez helikoptery.
					<br><br>
						Państwowa spółka <b>Strandfaraskip Landsins</b> odpowiada za autobusowe połączenia między miastami oraz sieć promową.
					<br><br>
						Helikoptery linii <b>Atlantic Airways</b> zapewniają rozkładowe loty oraz transport ładunków. Biorą także udział w akcjach ratowniczych i&nbsp;poszukiwawczych.
					</p>
					<ul>
						<!-- cat faroe-islands-latest.osm.bz2 | bzip2 -d | grep 'ferry_terminal' -c -->
						<!-- <li><span class="marker green"></span>bus stops<span class="tally">173</span></li>
						<li><span class="marker blue"></span>helipads<span class="tally">18</span></li>
						<li><span class="marker yellow"></span>ferries ports<span class="tally">23</span></li> -->
					</ul>
				</legend>

				<label id="atlantic-ocean">
					<span lang="en">Atlantic Ocean</span>
					<span lang="pl">Ocean Atlantycki</span>
				</label>
			</section>

			<img id="logo" src="static/logo.png" />

			<div id="map"></div>
			<section class="info">
				<div>
					<p>
						<strong lang="en">Research</strong><strong lang="pl">Opracowanie</strong>: Maciej Brencz @ farerskiekadry.pl
					</p>
					<p>
						<strong lang="en">Data</strong><strong lang="pl">Dane</strong>: Landsverk, Umhvørvisstovan, Strandfaraskip Landsins, OpenStreetMaps.
					</p>
				</div>

				<div>
					<p>
						<strong lang="en">Maps rendered with</strong><strong lang="pl">Mapy</strong> Leaflet
					</p>
					<p lang="en">
						<strong>Licensed under</strong> Creative Commons Attribution.
					</p>
					<p lang="pl">
						<strong>Licencja</strong> Creative Commons Uznanie autorstwa.
					</p>
				</div>
			</section>
		</section>

		<script>
		(async() => {
  			const center = [61.951667, -6.9675]; //west of Tórshavn
			const zoom = 10;
			const options = {
				zoomControl: false,
				attributionControl: false,
			};

			const map = setupMap('map', options, center, zoom);

			// paper-like background
			// map.createPane('paper');

			// add a countour of the Faroe Islands
			const countourData = await fetchGeoJSON('/geojson/us-lendiskort-us_lendiskort-15-oyggjar.json');
			const styleOptions = {
				// https://leafletjs.com/reference.html#path-option
				stroke: true,
				color: "#3c91d0ee",   // stroke
				fillColor: "#f2efe9", // fill
				fillOpacity: 1,
				weight: 3,
				opacity: 1,
				interactive: false,
			};

			// https://leafletjs.com/examples/map-panes/
			map.createPane('countour');
			map.createPane('countour-fg'); map.getPane('countour-fg').style.zIndex = 450;

			// https://leafletjs.com/examples/geojson/
			var geojson = L.geoJson(
				countourData,
				{
					style: {
						...styleOptions,
						color: "#3c91d033",   // stroke
						weight: 25,
						fill: false,
					},
					// filter: function(feature, layer) {
     				//    return true;
    				// },
					pane: 'countour'
				}
			).addTo(map);

			var geojson = L.geoJson(
				countourData,
				{
					style: {
						...styleOptions,
						color: "#3c91d0ee",   // stroke
						weight: 3,
					},
					// filter: function(feature, layer) {
     				//    return true;
    				// },
					pane: 'countour-fg'
				}
			).addTo(map);

			// https://leafletjs.com/reference.html#control-scale
			L.control.scale({
				metric: true,
				imperial: false,
				maxWidth: 350,
				position: 'bottomright',
			}).addTo(map);

			// https://github.com/turban/Leaflet.Graticule#example
			// Specify bold red lines instead of thin grey lines
			L.graticule({
				// https://leafletjs.com/reference.html#path
				style: {
					color: '#3c91d033',
					weight: 1
				},
				interval: 0.5
			}).addTo(map);

			// green / blue / yellow
			await addGeoJSONLayer(map, '/geojson/sona-busses.json', 'blue', 'intercity bus stops', 'przystanki autobusowe', (item) => {
				// properties: {name: '0032 Skopun', operator: 'SSL'}
				return item.properties.operator === 'SSL' || item.properties.bus === 'yes' /* from OSM */;
			});
			await addGeoJSONLayer(map, '/geojson/us-lendiskort-us_lendiskort-48-Tyrluplass.json', 'green', 'helipads', 'lądowiska dla helikopterów');
			await addGeoJSONLayer(map, '/geojson/osm-amenity-ferry_terminal.json', 'red', 'ferry terminals', 'promy');

			// L.marker([61.961667, -6.9675], {icon: getIcon('green')}).addTo(map);

			// what's the size of the webpage?
			const wrapper = document.getElementById('wrapper');
			console.log('Page size: ', {
				width: wrapper.clientWidth + 50 /* margin x2 */ + 10 /* border x2 */,
				height: wrapper.clientHeight + 50 + 10,
			});
		})();
		</script>

		<style>
			/**
			 * @see https://developer.mozilla.org/en-US/docs/Web/CSS/gradient/conic-gradient
			 */
			.marker.red {
				background: conic-gradient(transparent 0, transparent 180deg, #d73027 180deg);
			}
			.marker.green { 
				background: conic-gradient(#1a9850 0, #1a9850 180deg, transparent 180deg);
			}
		</style>

	</body>
</html>